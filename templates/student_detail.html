<!-- templates/new/course_list.html -->
{% extends 'base.html' %}

{% block title %}Talabalar ro'yxati{% endblock %}

{% block content %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Talabalar  ro'yxati</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container py-5">
    <h2 class="text-center mb-4">📘 Talabalar  ro'yxati</h2>
{% if user.is_authenticated and user.role != 'reader' %}
    <div class="mb-4 text-end">
        <a href="{% url 'student-create' %}" class="btn btn-primary">➕ Yangi talaba</a>
    </div>
    {% endif %}
    <div class="card shadow rounded-4">
        <div class="card-body">
            {% if student %}
            <div class="table-responsive">
                <table class="table table-striped table-hover align-middle">
                    <thead class="table-dark">
                        <tr>
                            <th scope="col">Tr</th>
                            <th scope="col">Nomi</th>
                            <th scope="col">Yoshi</th>
                            <th scope="col">Tanlagan kursi</th>
                            <th scope="col">Email</th>
                            <th scope="col">rasm</th>
                            <th scope="col">CV</th>
                            {% if user.is_authenticated and user.role != 'reader' %}
                            <th scope="col">action</th>
                            {%endif%}
                        </tr>
                    </thead>
                    <tbody>

                        <tr>
                            <th scope="row">{{ student.id }}</th>
                            <td>{{ student.full_name }}</td>
                            <td>{{ student.age }}</td>
                            <td>{{ student.course_name }}</td>
                            <td>{{ student.email }}</td>
                            {% if student.image %}
                            <td><img src="{{ student.image.url }}" width="300" ></td>
                            {% else %}
                            <td>Rasm mavjud emas</td>
                            {% endif %}
                             {% if student.file %}
                            <td><a href="{{ student.file.url }}">Yuklash</a> </td>
                            {% else %}
                            <td>fayl mavjud emas</td>
                            {% endif %}
                            {% if user.is_authenticated and user.role == 'reader' %}
                            <td><a href="{% url 'student-update' student.id %}" class="btn btn-primary"">Yangilash</a>
                             {% endif %}
                                {% if user.is_authenticated and user.role == 'admin'%}
                            <a href="{% url 'student-delete' student.id %}" class="btn btn-danger">O‘chirish</a>
                                {%endif%}
 </td>

                        </tr>

                    </tbody>
                </table>
            </div>
            {% else %}
            <p class="text-center text-muted">📭 Hozircha hech qanday talaba mavjud emas.</p>
            {% endif %}
        </div>
    </div>
    <br><br><br>

    <div class="mb-4 text-end">
        <a href="{% url 'student-list' %}" class="btn btn-secondary">← Orqaga</a>

    </div>
</div>

</body>
{% endblock %}
</html>
